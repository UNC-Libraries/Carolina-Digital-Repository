# Repository Environment Settings

# most server-specific settings are here
TOMCAT_USER=tomcat
JAVA_HOME=/usr/lib/jvm/java
REPO_DIR=/opt/repository
APR_LIB_PATH=/usr/local/apr/lib/
DATA_DIR=/opt/data

CATALINA_HOME=$REPO_DIR/tomcat
CATALINA_OUT=$DATA_DIR/logs/catalina.out
SOLR_HOME=$REPO_DIR/solr
FEDORA_HOME=$REPO_DIR/fedora
MULGARA_HOME=$REPO_DIR/mulgara
JETTY_HOME=$REPO_DIR/mulgara/jetty
JETTY_WORK=$REPO_DIR/mulgara/jetty/work
DJATOKA_HOME=$REPO_DIR/djatoka

DJATOKA_LIB="$DJATOKA_HOME/lib"
DJATOKA_BIN="$DJATOKA_HOME/bin"
LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$DJATOKA_LIB
DYLD_LIBRARY_PATH=$DYLD_LIBRARY_PATH

SOLR_DATA=$DATA_DIR/solr

CATALINA_OPTS="\
	-Djavax.xml.transform.TransformerFactory=net.sf.saxon.TransformerFactoryImpl \
	-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager \
	-Djava.util.logging.config.file=$CATALINA_HOME/conf/logging.properties \
	-Dlog.dir=$DATA_DIR/logs \
	-Dfedora.home=$FEDORA_HOME \
	-Dsolr.solr.home=$SOLR_HOME \
	-Dsolr.data.dir=$SOLR_DATA \
	-Djargon.debug=0 \
	-Djava.library.path=$APR_LIB_PATH:$DJATOKA_LIB \
	-Dserver.properties.uri=file:$REPO_DIR/server.properties \
	-Dcom.sun.management.jmxremote.host=localhost \
	-Djava.rmi.server.hostname=localhost \
	-Dcom.sun.management.jmxremote.password.file=$CATALINA_HOME/conf/jmxremote.password \
	-Dcom.sun.management.jmxremote.access.file=$CATALINA_HOME/conf/jmxremote.access \
	-Dcom.sun.management.jmxremote.ssl=false \
	-Dorg.apache.catalina.loader.WebappClassLoader.ENABLE_CLEAR_REFERENCES=false \
	-Dkakadu.home=$DJATOKA_BIN \
	-DLD_LIBRARY_PATH=$DJATOKA_LIB \
	-Xmx768m \
	-Xms512m \
	-XX:MaxPermSize=256m"

<% if @enable_debug %>
CATALINA_OPTS="-Xdebug -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=n $CATALINA_OPTS"
<% end %>

PATH=$JAVA_HOME/bin:$FEDORA_HOME/server/bin:$FEDORA_HOME/client/bin:$PATH

export PATH JAVA_HOME CATALINA_HOME CATALINA_OPTS CATALINA_OUT FEDORA_HOME MULGARA_HOME SOLR_HOME BACKUP_HOME JETTY_HOME JETTY_WORK LD_LIBRARY_PATH DYLD_LIBRARY_PATH KAKADU_HOME
